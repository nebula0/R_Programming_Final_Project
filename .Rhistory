theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title,
caption = "caption"
)
}
query <- "sum"
get_line(query)
library(reshape2)
library(ggplot2)
df = data.frame(cat = LETTERS[1:6], VAR1 = runif(6), VAR2 = runif(6), VAR3 = runif(6), VAR4 = runif(6))
df_melted = melt(df, id.vars = 'cat')
library(reshape2)
library(ggplot2)
df = data.frame(cat = LETTERS[1:6], VAR1 = runif(6), VAR2 = runif(6), VAR3 = runif(6), VAR4 = runif(6))
df_melted = melt(df, id.vars = 'cat')
library(reshape2)
library(ggplot2)
df = data.frame(cat = LETTERS[1:6], VAR1 = runif(6), VAR2 = runif(6), VAR3 = runif(6), VAR4 = runif(6))
df_melted = melt(df, id.vars = 'cat')
library(reshape2)
library(ggplot2)
df = data.frame(cat = LETTERS[1:6], VAR1 = runif(6), VAR2 = runif(6), VAR3 = runif(6), VAR4 = runif(6))
df_melted = melt(df, id.vars = 'cat')
cat
library(reshape2)
library(ggplot2)
df = data.frame(cat = LETTERS[1:6], VAR1 = runif(6), VAR2 = runif(6), VAR3 = runif(6), VAR4 = runif(6))
df_melted = melt(df, id.vars = 'cat')
df
df_melted
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = ww)
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = "ww")
library(reshape2)
library(ggplot2)
df = data.frame(cat = LETTERS[1:6], VAR1 = runif(6), VAR2 = runif(6), VAR3 = runif(6), VAR4 = runif(6))
df_melted = melt(df, id.vars = 'cat')
df
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = year)
t_quit_ratio
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_melt
t_quit_ratio_melt
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, color = variable))) +
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, color = variable)) +
geom_line()
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area()
quit_ratio = quit_school
colnames(quit_school)
length(colnames(quit_school))
area_plot_data <- data.frame()
# calculate ratio
for (i in 1:20) {
quit_ratio[2:64,i] <- (quit_school[2:64,i]/in_school[2:64,i]) * 100
}
t_quit_ratio <-  as.data.frame(t(quit_ratio))
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("臺灣大學", name_list[query, 1], "101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title,
caption = "caption"
) +
ggtitle("The race between ...")
}
query <- "sum"
get_line(query)
quit_ratio = quit_school
colnames(quit_school)
length(colnames(quit_school))
area_plot_data <- data.frame()
# calculate ratio
for (i in 1:20) {
quit_ratio[2:64,i] <- (quit_school[2:64,i]/in_school[2:64,i]) * 100
}
t_quit_ratio <-  as.data.frame(t(quit_ratio))
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("臺灣大學", name_list[query, 1], "101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title,
caption = "caption"
) +
}
quit_ratio = quit_school
colnames(quit_school)
length(colnames(quit_school))
area_plot_data <- data.frame()
# calculate ratio
for (i in 1:20) {
quit_ratio[2:64,i] <- (quit_school[2:64,i]/in_school[2:64,i]) * 100
}
t_quit_ratio <-  as.data.frame(t(quit_ratio))
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("臺灣大學", name_list[query, 1], "101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title,
caption = "caption"
)
}
query <- "sum"
get_line(query)
name_list <-  (read.csv("科系代號.csv", header = F, row.names = 1))
quit_ratio = quit_school
colnames(quit_school)
length(colnames(quit_school))
area_plot_data <- data.frame()
# calculate ratio
for (i in 1:20) {
quit_ratio[2:64,i] <- (quit_school[2:64,i]/in_school[2:64,i]) * 100
}
t_quit_ratio <-  as.data.frame(t(quit_ratio))
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("臺灣大學", name_list[query, 1], "101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title,
caption = "caption"
)
}
query <- "sum"
get_line(query)
quit_ratio = quit_school
colnames(quit_school)
length(colnames(quit_school))
area_plot_data <- data.frame()
# calculate ratio
for (i in 1:20) {
quit_ratio[2:64,i] <- (quit_school[2:64,i]/in_school[2:64,i]) * 100
}
t_quit_ratio <-  as.data.frame(t(quit_ratio))
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("國立臺灣大學", name_list[query, 1], "101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title,
caption = "caption"
)
}
query <- "sum"
get_line(query)
quit_ratio = quit_school
colnames(quit_school)
length(colnames(quit_school))
area_plot_data <- data.frame()
# calculate ratio
for (i in 1:20) {
quit_ratio[2:64,i] <- (quit_school[2:64,i]/in_school[2:64,i]) * 100
}
t_quit_ratio <-  as.data.frame(t(quit_ratio))
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("國立臺灣大學", name_list[query, 1], "101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title,
# caption = "caption"
)
}
query <- "sum"
get_line(query)
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=1, colour="black")
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
t_quit_ratio_melt
t_quit_ratio
t_quit_ratio$year
t_quit_ratio[1,]
sum(t_quit_ratio[1,])
sum(as.numeric(t_quit_ratio[1,])
)
as.numeric(t_quit_ratio[1,]
)
as.numeric(t_quit_ratio[1,])
sum(as.numeric(t_quit_ratio[1,]))
sum(as.numeric(t_quit_ratio[1,]), na.rm = T)
t_quit_ratio
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage <- t_quit_ratio
for (i in 1:21) {
S = sum(as.numeric(t_quit_ratio[i,]), na.rm = T)
t_quit_ratio_percentage[i,] <- t_quit_ratio_percentage[i,]/S
}
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
t_quit_ratio_percentage
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage <- t_quit_ratio
for (i in 1:21) {
S = sum(as.numeric(t_quit_ratio[i,]), na.rm = T)
t_quit_ratio_percentage[i,] <- 100 * t_quit_ratio_percentage[i,]/S
}
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
t_quit_ratio_percentage
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage <- t_quit_ratio
for (i in 1:21) {
S = sum(as.numeric(t_quit_ratio[i,]), na.rm = T)
t_quit_ratio_percentage[i,] <- 100 * t_quit_ratio_percentage[i,]/S
}
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage <- t_quit_ratio
for (i in 1:21) {
S = sum(as.numeric(t_quit_ratio[i,]), na.rm = T)
t_quit_ratio_percentage[i,] <- 100 * t_quit_ratio_percentage[i,]/S
}
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_percentage_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage <- t_quit_ratio
for (i in 1:21) {
S = sum(as.numeric(t_quit_ratio[i,]), na.rm = T)
t_quit_ratio_percentage[i,] <- 100 * t_quit_ratio_percentage[i,]/S
}
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, color = variable)) +
geom_line()
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
query <- "sum"
get_line(query)
query <- 'B010'
get_line(query)
t_quit_ratio
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, color = variable)) +
geom_line()
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
quit_ratio = quit_school
colnames(quit_school)
length(colnames(quit_school))
area_plot_data <- data.frame()
# calculate ratio
for (i in 1:20) {
quit_ratio[2:64,i] <- (quit_school[2:64,i]/in_school[2:64,i]) * 100
}
# transpose the matrix, let departments and year be the column names.
t_quit_ratio <-  as.data.frame(t(quit_ratio))
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("國立臺灣大學", name_list[query, 1],
"101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title
)
}
length(colnames(quit_school))
length(rownames(quit_school))
dim(quit_school)
knitr::opts_chunk$set(echo = TRUE)
name_list <-  (read.csv("科系代號.csv", header = F, row.names = 1))
in_school <- read.csv("在學人數表.csv", header = F, row.names = 1)
str(in_school)
in_school
quit_school <- read.csv("休學統計表EXCEL.csv", header = F, row.names = 1)
str(quit_school)
quit_school
quit_ratio = quit_school
colnames(quit_school)
colnum <- dim(quit_school)[2]
rownum <- dim(quit_school)[1]
# calculate ratio
for (i in 1:colnum) {
quit_ratio[2:rownum,i] <- (quit_school[2:rownum,i]/in_school[2:rownum,i]) * 100
}
# transpose the matrix, let departments and year be the column names.
t_quit_ratio <-  as.data.frame(t(quit_ratio))
# define a function to plot corresponding plot.
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("國立臺灣大學", name_list[query, 1],
"101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title
)
}
# call the function
query <- "sum"
get_line(query)
query <- 'B010'
get_line(query)
# melt function arange dataframe to the form which can let geom_area plot it.
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, color = variable)) +
geom_line()
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
# import library
library(ggplot2)
library("reshape2")
name_list <-  (read.csv("科系代號.csv", header = F, row.names = 1))
in_school <- read.csv("在學人數表.csv", header = F, row.names = 1)
str(in_school)
in_school
quit_school <- read.csv("休學統計表EXCEL.csv", header = F, row.names = 1)
str(quit_school)
quit_school
quit_ratio = quit_school
colnames(quit_school)
colnum <- dim(quit_school)[2]
rownum <- dim(quit_school)[1]
# calculate ratio
for (i in 1:colnum) {
quit_ratio[2:rownum,i] <- (quit_school[2:rownum,i]/in_school[2:rownum,i]) * 100
}
# transpose the matrix, let departments and year be the column names.
t_quit_ratio <-  as.data.frame(t(quit_ratio))
# define a function to plot corresponding plot.
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("國立臺灣大學", name_list[query, 1],
"101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title
)
}
# call the function
query <- "sum"
get_line(query)
query <- 'B010'
get_line(query)
# melt function arange dataframe to the form which can let geom_area plot it.
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, color = variable)) +
geom_line()
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
# import library
library(ggplot2)
library("reshape2")
name_list <-  (read.csv("科系代號.csv", header = F, row.names = 1))
in_school <- read.csv("在學人數表.csv", header = F, row.names = 1)
str(in_school)
in_school
quit_school <- read.csv("休學統計表EXCEL.csv", header = F, row.names = 1)
str(quit_school)
quit_school
quit_ratio = quit_school
colnames(quit_school)
colnum <- dim(quit_school)[2]
rownum <- dim(quit_school)[1]
# calculate ratio
for (i in 1:colnum) {
quit_ratio[2:rownum,i] <- (quit_school[2:rownum,i]/in_school[2:rownum,i]) * 100
}
# transpose the matrix, let departments and year be the column names.
t_quit_ratio <-  as.data.frame(t(quit_ratio))
# define a function to plot corresponding plot.
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("國立臺灣大學", name_list[query, 1],
"101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title
)
}
# call the function
query <- "sum"
get_line(query)
query <- 'B010'
get_line(query)
# melt function arange dataframe to the form which can let geom_area plot it.
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
t_quit_ratio_percentage_melt <- melt(t_quit_ratio_percentage, id.vars = 'year')
# melt function arange dataframe to the form which can let geom_area plot it.
t_quit_ratio_melt <- melt(t_quit_ratio, id.vars = 'year')
ggplot(data = t_quit_ratio_melt, aes(x = year, y = value, fill = variable)) +
geom_area(size=0.1, colour="black")
sessionInfo()
# import library
library(ggplot2)
library(reshape2)
name_list <-  (read.csv("科系代號.csv", header = F, row.names = 1))
str(name_list)
in_school <- read.csv("在學人數表.csv", header = F, row.names = 1)
str(in_school)
in_school <- read.csv("在學人數表.csv", header = F, row.names = 1)
str(in_school)
head(in_school)
quit_school <- read.csv("休學統計表EXCEL.csv", header = F, row.names = 1)
str(quit_school)
head(quit_school)
quit_ratio = quit_school
colnames(quit_school)
colnum <- dim(quit_school)[2]
rownum <- dim(quit_school)[1]
# calculate ratio
for (i in 1:colnum) {
quit_ratio[2:rownum,i] <- (quit_school[2:rownum,i]/in_school[2:rownum,i]) * 100
}
# transpose the matrix, let departments and year be the column names.
t_quit_ratio <-  as.data.frame(t(quit_ratio))
# define a function to plot corresponding plot.
get_line <- function(query){
y = t_quit_ratio[,query]
title = paste("國立臺灣大學", name_list[query, 1],
"101 年至 111 年休學率", sep = "")
ggplot(data = t_quit_ratio, aes(x = year, y = y)) +
geom_line(aes(group=1)) +
geom_point()  +
theme(axis.text.x = element_text(angle = 60, vjust = 0.5, hjust=1)) +
ylim(0, 20) +
labs(
x = "學年度",
y = "百分比",
title = title
)
}
dim(quit_school)
